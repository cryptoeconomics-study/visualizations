(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{13:function(e,t,n){function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.getPrototypeOf||function(e){return e.__proto__})(e)}for(var c=n(138),l=n(328),u=function(e){function t(e,n,o){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=a(this,s(t).call(this,e,n,o))).pausedSpending=!0,r}var n,o,c;return n=t,(o=[{key:"getRandomReceiver",value:function(){var e=this,t=g.filter(function(t){return t.wallet.address!==e.wallet.address});return t[Math.floor(Math.random()*t.length)].wallet.address}},{key:"tick",value:function(){if(!(this.state[this.wallet.address].balance<10||this.pausedSpending)&&Math.random()<.01){var e=this.generateTx(this.getRandomReceiver(),10);this.transactions.push(e),this.applyTransaction(e),this.network.broadcast(this.pid,e)}}}])&&i(n.prototype,o),c&&i(n,c),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r(e.prototype,t&&t.prototype),t&&r(e,t)}(t,e),t}(n(318).Node),h=[],d={},p=new l(15,0),f=0;f<4;f++)h.push(c.createIdentity()),d[h[f].address]={balance:100,nonce:0};for(var g=[],y=0;y<4;y++)g.push(new u(h[y],JSON.parse(JSON.stringify(d)),p)),p.connectPeer(g[y],2);e.exports={nodes:g,network:p}},228:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(18),a=n.n(i),s=(n(441),n(440),n(69)),c=n(47),l=n(2),u=n(206),h={SYMBOLS:{CIRCLE:"circle",CROSS:"cross",DIAMOND:"diamond",SQUARE:"square",STAR:"star",TRIANGLE:"triangle",WYE:"wye"}};function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){d(e,t,n[t])})}return e}({COORDS_SEPARATOR:",",FORCE_IDEAL_STRENGTH:-1e3,FORCE_X:.06,FORCE_Y:.06,GRAPH_CONTAINER_ID:"graph-container-zoomable",GRAPH_WRAPPER_ID:"graph-wrapper",KEYWORDS:{SAME:"SAME"},LINK_CLASS_NAME:"link",NODE_CLASS_NAME:"node"},h),f={automaticRearrangeAfterDropNode:!1,height:1e3,highlightDegree:1,highlightOpacity:1,linkHighlightBehavior:!1,maxZoom:8,minZoom:1,nodeHighlightBehavior:!1,panAndZoom:!1,staticGraph:!1,width:1e3,node:{color:"#d3d3d3",fontColor:"black",fontSize:8,fontWeight:"normal",highlightColor:"SAME",highlightFontSize:8,highlightFontWeight:"normal",highlightStrokeColor:"SAME",highlightStrokeWidth:1.5,labelProperty:"id",mouseCursor:"pointer",opacity:1,renderLabel:!0,size:200,strokeColor:"none",strokeWidth:1.5,svg:"",symbolType:"circle"},link:{color:"#000000",opacity:1,semanticStrokeWidth:!1,strokeWidth:1.5,highlightColor:"#d3d3d3"}},g={GRAPH_NO_ID_PROP:"id prop not defined! id property is mandatory and it should be unique.",INVALID_LINKS:"you provided a invalid links data structure. Links source and target attributes must point to an existent node",INSUFFICIENT_DATA:"you have not provided enough data for react-d3-graph to render something. You need to provide at least one node"};function y(e){return(y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.getPrototypeOf||function(e){return e.__proto__})(e)}var O=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return b(o,(n=o=b(this,(e=k(t)).call.apply(e,[this].concat(i))),o.handleOnMouseOverLink=function(){return o.props.onMouseOverLink&&o.props.onMouseOverLink(o.props.source,o.props.target)},o.handleOnMouseOutLink=function(){return o.props.onMouseOutLink&&o.props.onMouseOutLink(o.props.source,o.props.target)},n))}var n,o,i;return n=t,(o=[{key:"render",value:function(){var e={strokeWidth:this.props.strokeWidth,stroke:this.props.stroke,opacity:this.props.opacity},t={className:this.props.className,onClick:this.handleOnClickLink,onMouseOut:this.handleOnMouseOutLink,onMouseOver:this.handleOnMouseOverLink,style:e,x1:this.props.x1,x2:this.props.x2,y1:this.props.y1,y2:this.props.y2};return r.a.createElement("line",t)}}])&&v(n.prototype,o),i&&v(n,i),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");m(e.prototype,t&&t.prototype),t&&m(e,t)}(t,e),t}(r.a.Component);function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){S(e,t,n[t])})}return e}({ARC:{START_ANGLE:0,END_ANGLE:2*Math.PI},DEFAULT_NODE_SIZE:f.node.size,NODE_LABEL_DX:".90em",NODE_LABEL_DY:".35em"},h),w=n(29);var N={buildSvgSymbol:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.DEFAULT_NODE_SIZE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.SYMBOLS.CIRCLE;return Object(w.a)().size(function(){return e}).type(function(){return function(e){switch(e){case E.SYMBOLS.CIRCLE:return w.b;case E.SYMBOLS.CROSS:return w.c;case E.SYMBOLS.DIAMOND:return w.d;case E.SYMBOLS.SQUARE:return w.e;case E.SYMBOLS.STAR:return w.f;case E.SYMBOLS.TRIANGLE:return w.g;case E.SYMBOLS.WYE:return w.h;default:return w.b}}(t)})()}};function _(e){return(_="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function x(e,t){return!t||"object"!==_(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.getPrototypeOf||function(e){return e.__proto__})(e)}var j=function(e){function t(){var e,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return x(o,(n=o=x(this,(e=M(t)).call.apply(e,[this].concat(i))),o.handleOnClickNode=function(){return o.props.onClickNode&&o.props.onClickNode(o.props.id)},o.handleOnMouseOverNode=function(){return o.props.onMouseOverNode&&o.props.onMouseOverNode(o.props.id)},o.handleOnMouseOutNode=function(){return o.props.onMouseOut&&o.props.onMouseOut(o.props.id)},n))}var n,o,i;return n=t,(o=[{key:"render",value:function(){var e,t,n,o={cursor:this.props.cursor,onClick:this.handleOnClickNode,onMouseOut:this.handleOnMouseOutNode,onMouseOver:this.handleOnMouseOverNode,opacity:this.props.opacity},i={dx:this.props.dx||E.NODE_LABEL_DX,dy:E.NODE_LABEL_DY,fill:this.props.fontColor,fontSize:this.props.fontSize,fontWeight:this.props.fontWeight,opacity:this.props.opacity},a=this.props.size,s=this.props.cx,c=this.props.cy;if(this.props.svg){var l=a/10,u=a/10,h=u/2,d=l/2,p="translate(".concat(h,",").concat(d,")");e=r.a.createElement("text",Object.assign({},i,{transform:p}),this.props.label),t=r.a.createElement("image",Object.assign({},o,{href:this.props.svg,width:u,height:l})),s-=h,c-=d}else{if(this.props.gerbil){var f=a/27,g=a/27,y=g/2,m=f/2,v="translate(".concat(y,",").concat(m,")");e=r.a.createElement("text",Object.assign({},i,{transform:v}),this.props.label),n=r.a.createElement("g",{transform:"translate("+-y+","+-m+")"},r.a.createElement("image",Object.assign({},o,{href:this.props.gerbil,width:g,height:f})))}o.d=N.buildSvgSymbol(a,this.props.type),o.fill=this.props.fill,o.stroke=this.props.stroke,o.strokeWidth=this.props.strokeWidth,e=r.a.createElement("text",i,this.props.label),t=r.a.createElement("path",o)}var b={className:this.props.className,cx:this.props.cx,cy:this.props.cy,id:this.props.id,transform:"translate(".concat(s,",").concat(c,")")};return r.a.createElement("g",b,t,this.props.renderLabel&&e,n)}}])&&C(n.prototype,o),i&&C(n,i),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");T(e.prototype,t&&t.prototype),t&&T(e,t)}(t,e),t}(r.a.Component);function P(e){return(P="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var L=20;function A(e,t){return e.hasOwnProperty(t)&&"object"===P(e[t])&&null!==e[t]&&!R(e[t])}function R(e){return!!e&&"object"===P(e)&&!Object.keys(e).length}var D={isDeepEqual:function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if(0===o&&t===n)return!0;if(R(t)&&!R(n)||!R(t)&&R(n))return!1;var i=Object.keys(t),a=Object.keys(n);if(i.length!==a.length)return!1;for(var s=0;s<i.length;s++){var c=i[s];if(A(t,c)&&A(n,c)&&o<L)r.push(e(t[c],n[c],o+1));else{var l=R(t[c])&&R(n[c])||n.hasOwnProperty(c)&&n[c]===t[c];if(r.push(l),!l)break}}return-1===r.indexOf(!1)},isObjectEmpty:R,merge:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r={};if(0===Object.keys(t||{}).length)return n&&!R(n)?n:{};for(var i=Object.keys(t),a=0;a<i.length;a++){var s=i[a];n[s]&&"object"===P(n[s])&&"object"===P(t[s])&&o<L?function(){var i=e(t[s],n[s],o+1);r[s]=t[s].hasOwnProperty("length")&&n[s].hasOwnProperty("length")?Object.keys(i).map(function(e){return i[e]}):i}():r[s]=n.hasOwnProperty(s)?n[s]:t[s]}return r},pick:function(e,t){return Object.keys(e).reduce(function(n,o){return e.hasOwnProperty(o)&&t.includes(o)&&(n[o]=e[o]),n},{})},throwErr:function(e,t){var n="react-d3-graph :: ".concat(e," :: ").concat(t);throw Error(n)}};function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=["id","highlighted","x","y","index","vy","vx"];function G(e,t,n,o){var r=e.highlighted||e.id===(n&&n.source)||e.id===(n&&n.target),i=!!(t||n&&n.source&&n.target);return i&&0===o.highlightDegree?r?o.node.opacity:o.highlightOpacity:i?r?o.node.opacity:o.highlightOpacity:o.node.opacity}function z(e,t){var n,o=e.data,r=e.id,i=e.config;!function(e){e.nodes&&e.nodes.length||D.throwErr("Graph",g.INSUFFICIENT_DATA);for(var t=e.links.length,n=function(t){var n=e.links[t];e.nodes.find(function(e){return e.id===n.source})||D.throwErr("Graph","".concat(g.INVALID_LINKS,' - "').concat(n.source,'" is not a valid source node id')),e.nodes.find(function(e){return e.id===n.target})||D.throwErr("Graph","".concat(g.INVALID_LINKS,' - "').concat(n.target,'" is not a valid target node id'))},o=0;o<t;o++)n(o)}(o);var a=o.nodes.map(function(e){return Object.assign({},e)}),s=o.links.map(function(e){return Object.assign({},e)});(n=t&&t.nodes&&t.links?{nodes:o.nodes.map(function(e){return t.nodes[e.id]?Object.assign({},e,D.pick(t.nodes[e.id],W)):Object.assign({},e)}),links:{}}:{nodes:o.nodes.map(function(e){return Object.assign({},e)}),links:{}}).links=o.links.map(function(e){return Object.assign({},e)});var l,u,h,d,y=Object.assign({},D.merge(f,i||{})),m=function(e){for(var t={},n=e.length,o=0;o<n;o++){var r=e[o];r.highlighted=!1,r.hasOwnProperty("x")||(r.x=0),r.hasOwnProperty("y")||(r.y=0),t[r.id.toString()]=r}return t}(n.nodes),v=n.links.reduce(function(e,t){var n=t.source.id||t.source,o=t.target.id||t.target;return e[n]||(e[n]={}),e[o]||(e[o]={}),e[n][o]=e[o][n]=t.value||1,e},{}),b=n,k=b.nodes,O=b.links;return{id:r.replace(/ /g,"_"),config:y,links:v,d3Links:O,linksInputSnapshot:s,nodes:m,d3Nodes:k,nodesInputSnapshot:a,highlightedNode:"",simulation:(l=y.width,u=y.height,h=Object(c.d)(l/2).strength(p.FORCE_X),d=Object(c.e)(u/2).strength(p.FORCE_Y),Object(c.c)().force("charge",Object(c.b)().strength(p.FORCE_IDEAL_STRENGTH)).force("x",h).force("y",d)),newGraphElements:!1,configUpdated:!1,transform:1}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t,n,o,i,a,s,c){return t.map(function(t){var l=t.source,u=t.target,h=l.id||l,d=u.id||u,f="".concat(h).concat(p.COORDS_SEPARATOR).concat(d),g=function(e,t,n,o,r,i,a,s){var c=e.source,l=e.target,u=t[c]&&t[c].x||0,h=t[c]&&t[c].y||0,d=t[l]&&t[l].x||0,f=t[l]&&t[l].y||0,g=!1;switch(o.highlightDegree){case 0:break;case 2:g=!0;break;default:g=c===i||l===i}var y=g&&t[c].highlighted&&t[l].highlighted,m=c===(a&&a.source)&&l===(a&&a.target),v=y||m,b=o.link.opacity;(i||a&&a.source)&&(b=v?o.link.opacity:o.highlightOpacity);var k=e.color||o.link.color;v&&(k=o.link.highlightColor===p.KEYWORDS.SAME?o.link.color:o.link.highlightColor);var O=o.link.strokeWidth*(1/s);return o.link.semanticStrokeWidth&&(O+=(n[c][l]||n[l][c]||1)*O/10),{source:c,target:l,x1:u,y1:h,x2:d,y2:f,strokeWidth:O,stroke:k,className:p.LINK_CLASS_NAME,opacity:b,onClickLink:r.onClickLink,onMouseOverLink:r.onMouseOverLink,onMouseOutLink:r.onMouseOutLink}}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){B(e,t,n[t])})}return e}({},t,{source:"".concat(h),target:"".concat(d)}),e,n,o,i,"".concat(a),s,c);return r.a.createElement(O,Object.assign({key:f},g))})}function H(e,t,n,o,i,a,s,c){return Object.keys(e).map(function(l){var u;if(e[l].isMessage){u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,a=e.highlighted||e.id===(r&&r.source)||e.id===(r&&r.target),s=G(e,o,r,t),c=t.node.strokeColor;a&&t.node.highlightStrokeColor!==p.KEYWORDS.SAME&&(c=t.node.highlightStrokeColor);var l=1/i,u=e.size||t.node.size,h=(a?t.node.highlightFontSize:t.node.fontSize)*l+u/100+1.5,d=a?t.node.highlightStrokeWidth:t.node.strokeWidth,f=e.svg||t.node.svg,g=e.fontColor||t.node.fontColor;return{className:p.NODE_CLASS_NAME,cursor:t.node.mouseCursor,cx:e&&e.x||"0",cy:e&&e.y||"0",fill:"#00FF1E",fontColor:g,fontSize:0,dx:h,fontWeight:a?t.node.highlightFontWeight:t.node.fontWeight,id:e.id,label:"",onClickNode:n.onClickNode,onMouseOverNode:n.onMouseOverNode,onMouseOut:n.onMouseOut,opacity:s,renderLabel:t.node.renderLabel,size:15*l,stroke:c,strokeWidth:d*l,svg:f,type:e.symbolType||t.node.symbolType}}(Object.assign({},e[l],{id:"".concat(l)}),n,{},o,i,a);var h=e[l].sig.substring(2,8);u.fill="#"+h,e[l].isDoubleSpend&&(u.size=18,u.stroke="#ff0000",u.strokeWidth=1)}else if(u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,a=e.highlighted||e.id===(r&&r.source)||e.id===(r&&r.target),s=G(e,o,r,t),c=e.color||t.node.color;a&&t.node.highlightColor!==p.KEYWORDS.SAME&&(c=t.node.highlightColor);var l=t.node.strokeColor;a&&t.node.highlightStrokeColor!==p.KEYWORDS.SAME&&(l=t.node.highlightStrokeColor);var u=1/i,h=e.size||t.node.size,d=a?t.node.highlightFontSize:t.node.fontSize,f=d*u+h/100+1.5,g=a?t.node.highlightStrokeWidth:t.node.strokeWidth,y=e.svg||t.node.svg,m=e.gerbil,v=e.fontColor||t.node.fontColor;return{className:p.NODE_CLASS_NAME,cursor:t.node.mouseCursor,cx:e&&e.x||"0",cy:e&&e.y||"0",fill:c,fontColor:v,fontSize:d*u,dx:f,fontWeight:a?t.node.highlightFontWeight:t.node.fontWeight,gerbil:m,id:e.id,label:e[t.node.labelProperty]||e.id,onClickNode:n.onClickNode,onMouseOverNode:n.onMouseOverNode,onMouseOut:n.onMouseOut,opacity:s,renderLabel:t.node.renderLabel,size:h*u,stroke:l,strokeWidth:g*u,svg:y,type:e.symbolType||t.node.symbolType}}(Object.assign({},e[l],{id:"".concat(l)}),n,t,o,i,a),s){var d=s(l,Math.floor(c));u.fill=d.color}return r.a.createElement(j,Object.assign({key:l},u))})}var Y=function(e){var t=e.doubleSpend,n=e.spend,o=e.hide;return r.a.createElement("div",{id:"NodeControls"},r.a.createElement("button",{id:"doubleSpend",onClick:function(){t(),o()}},"Double Spend"),r.a.createElement("button",{id:"spend",onClick:function(){n(),o()}},"Spend"))};function K(e){return(K="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function J(e,t){return!t||"object"!==K(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e){return(Z=Object.getPrototypeOf||function(e){return e.__proto__})(e)}var V,X={FORCE_LINK_STRENGTH:1,LINK_IDEAL_DISTANCE:100,SIMULATION_ALPHA_TARGET:.05};function $(e,t){return Object.keys(e).find(function(n){return e[n]===t})}var ee=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=J(this,Z(t).call(this,e)))._onDragEnd=function(){!n.state.config.staticGraph&&n.state.config.automaticRearrangeAfterDropNode&&n.state.simulation.alphaTarget(X.SIMULATION_ALPHA_TARGET).restart(),V<10&&Object(l.f)(window).on("click.drag",null)},n._onDragMove=function(e,t,o){var r=o[t].id;if(!n.state.config.staticGraph){var i=n.state.nodes[r];i.x+=l.b.dx,i.y+=l.b.dy,i.fx=i.x,i.fy=i.y,n._tick(),n.animate()}V+=l.b.dx*l.b.dx+l.b.dy*l.b.dy},n._onDragStart=function(){n.pauseSimulation(),V=0},n._setNodeHighlightedValue=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n._tick(function(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=r?o:"",a=Object.assign({},e[o],{highlighted:r}),s=Object.assign({},e,I({},o,a));return t[o]&&0!==n.highlightDegree&&(s=Object.keys(t[o]).reduce(function(e,t){var n=Object.assign({},s[t],{highlighted:r});return Object.assign(e,I({},t,n))},s)),{nodes:s,highlightedNode:i}}(n.state.nodes,n.state.links,n.state.config,e,t))},n._tick=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.setState(e)},n._zoomConfig=function(){return Object(l.f)("#".concat(n.state.id,"-").concat(p.GRAPH_WRAPPER_ID)).call(Object(u.a)().scaleExtent([n.state.config.minZoom,n.state.config.maxZoom]).on("zoom",n._zoomed))},n._zoomed=function(){var e=l.b.transform;Object(l.g)("#".concat(n.state.id,"-").concat(p.GRAPH_CONTAINER_ID)).attr("transform",e),n.state.config.panAndZoom&&n.setState({transform:e.k})},n.onMouseOverNode=function(e){},n.onMouseOutNode=function(e){n.props.onMouseOutNode&&n.props.onMouseOutNode(e),n.state.config.nodeHighlightBehavior&&n._setNodeHighlightedValue(e,!1)},n.onMouseOverLink=function(e,t){n.props.onMouseOverLink&&n.props.onMouseOverLink(e,t),n.state.config.linkHighlightBehavior&&(n.setState({highlightedLink:{source:e,target:t}}),n._tick())},n.onMouseOutLink=function(e,t){n.props.onMouseOutLink&&n.props.onMouseOutLink(e,t),n.state.config.linkHighlightBehavior&&(n.setState({highlightedLink:void 0}),n._tick())},n.pauseSimulation=function(){return n.state.simulation.stop()},n.resetNodesPositions=function(){if(!n.state.config.staticGraph){for(var e in n.state.nodes){var t=n.state.nodes[e];t.fx&&t.fy&&(Reflect.deleteProperty(t,"fx"),Reflect.deleteProperty(t,"fy"))}n.state.simulation.alphaTarget(X.SIMULATION_ALPHA_TARGET).restart(),n._tick()}},n.restartSimulation=function(){return!n.state.config.staticGraph&&n.state.simulation.restart()},n.props.id||D.throwErr(n.constructor.name,g.GRAPH_NO_ID_PROP),n.state=z(n.props,n.state),n.state.time=0,n.state.paused=!1,n}var n,o,i;return n=t,(o=[{key:"componentWillReceiveProps",value:function(e){var t=e.data.nodes.length!==this.state.nodesInputSnapshot.length||e.data.links.length!==this.state.linksInputSnapshot.length||!D.isDeepEqual(e.data,{nodes:this.state.nodesInputSnapshot,links:this.state.linksInputSnapshot}),n=!D.isObjectEmpty(e.config)&&!D.isDeepEqual(e.config,this.state.config),o=t?z(e,this.state):this.state,r=n?D.merge(f,e.config||{}):this.state.config;t&&this.pauseSimulation();var i=e.config.panAndZoom!==this.state.config.panAndZoom?1:this.state.transform;this.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){U(e,t,n[t])})}return e}({},o,{config:r,newGraphElements:t,configUpdated:n,transform:i})),e.messages&&this.setState({messages:e.messages}),e.speed&&this.setState({speed:e.speed}),e.nodeState&&this.setState({nodeState:e.nodeState});var a=this.state.paused;this.setState({paused:e.paused},function(){a&&!e.paused&&this.tick()})}},{key:"onClickNode",value:function(e){if(this.state.clickedNode&&this.state.clickedNode.id===e)this.setState({clickedNode:null});else{var t=this.state.nodes[e];this.setState({clickedNode:t})}}},{key:"componentDidUpdate",value:function(){this.state.config.staticGraph&&this.pauseSimulation(),!this.state.config.staticGraph&&this.state.newGraphElements&&(this._graphForcesConfig(),this.restartSimulation(),this.setState({newGraphElements:!1})),this.state.configUpdated&&(this._zoomConfig(),this.setState({configUpdated:!1}))}},{key:"componentDidMount",value:function(){this.state.config.staticGraph||this._graphForcesConfig(),this._zoomConfig(),this.tick=this.tick.bind(this),this.animate=this.animate.bind(this),this.getTick=this.props.onTick,this.start()}},{key:"componentWillUnmount",value:function(){this.pauseSimulation()}},{key:"start",value:function(){this.tick(),this.getTick(0)}},{key:"tick",value:function(){if(this.state.paused)console.log("paused!");else{var e=this.state.time,t=this.state.time+.1;this.animate(),Math.floor(t)-Math.floor(e)===1&&this.getTick(Math.floor(t)),this.animate(),this.setState({time:t}),requestAnimationFrame(this.tick)}}},{key:"step",value:function(e){var t=this.state.messages,n=this.state.nodes;console.log(n);for(var o=0;o<t.length;o++){var r=$(n,t[o].node);console.log("to delete:",r),delete n[r]}console.log(n),this.animate(),this.setState({time:e},function(){console.log("SET TIME TO",this.state.time),this.getTick(e),this.animate()})}},{key:"animate",value:function(){var e=this.state.messages;if(e){for(var t=0;t<e.length;t++){var n=this.state.nodes;if(!e[t].key&&(e[t].key=e[t].message.sig+e[t].sender+e[t].recipient.pid+e[t].rcvTime,!e[t].node))if(n[e[t].key])e[t].node=n[e[t].key];else{var o=new j;o.isMessage=!0,o.isDoubleSpend=e[t].message.isDoubleSpend,o.sig=e[t].message.sig,e[t].node=o,n[e[t].key]=o}var r=e[t].node,i=(this.state.time-e[t].sentTime)/(e[t].recvTime-e[t].sentTime);if(i<=1&&i>=0){var a=n[e[t].sender],s=n[e[t].recipient.pid];r.x=a.x,r.y=a.y,r.x=s.x,r.y=s.y,r.x=i*(s.x-a.x)+a.x,r.y=i*(s.y-a.y)+a.y}else i>1&&(delete n[e[t].key],e.splice(t,1))}this.setState({messages:e})}}},{key:"render",value:function(){var e=this.props,t=e.doubleSpend,n=e.spend,o=e.deselectNode,i=e.clickedNode,a=function(e,t,n,o,r,i,a,s,c,l,u){return{nodes:H(e,t,i,a,s,c,l,u),links:F(e,n,o,i,r,a,s,c)}}(this.state.nodes,{onClickNode:this.props.onClickNode,onMouseOverNode:this.onMouseOverNode,onMouseOut:this.onMouseOutNode},this.state.d3Links,this.state.links,{onClickLink:this.props.onClickLink,onMouseOverLink:this.onMouseOverLink,onMouseOutLink:this.onMouseOutLink},this.state.config,this.state.highlightedNode,this.state.highlightedLink,this.state.transform,this.state.nodeState,this.state.time),s=a.nodes,c=a.links,l="";i&&(l=r.a.createElement("foreignObject",{x:this.state.nodes[i.pid].x,y:this.state.nodes[i.pid].y},r.a.createElement(Y,{doubleSpend:function(){return t(i)},spend:function(){return n(i)},hide:o})));return r.a.createElement("div",{id:"".concat(this.state.id,"-").concat(p.GRAPH_WRAPPER_ID)},r.a.createElement("svg",{style:{maxHeight:"100%",maxWidth:"100%",viewBox:"0 0 1000 1000",preserveAspectRatio:"xMaxYMax"}},r.a.createElement("g",{id:"".concat(this.state.id,"-").concat(p.GRAPH_CONTAINER_ID)},c,s,l)))}},{key:"_graphForcesConfig",value:function(){this.state.simulation.nodes(this.state.d3Nodes).on("tick",this._tick);var e=Object(c.a)(this.state.d3Links).id(function(e){return e.id}).distance(X.LINK_IDEAL_DISTANCE).strength(X.FORCE_LINK_STRENGTH);this.state.simulation.force(p.LINK_CLASS_NAME,e);var t=Object(s.a)().on("start",this._onDragStart).on("drag",this._onDragMove).on("end",this._onDragEnd);Object(l.f)("#".concat(this.state.id,"-").concat(p.GRAPH_WRAPPER_ID)).selectAll(".node").call(t)}}])&&q(n.prototype,o),i&&q(n,i),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Q(e.prototype,t&&t.prototype),t&&Q(e,t)}(t,e),t}(r.a.Component),te=n(13),ne=n(136),oe=n(137),re=n(224),ie=n.n(re),ae=function(e){var t=e.paused,n=e.onPause,o=e.onPauseTxs,i=(e.pausedTxs,e.togglePopup);return r.a.createElement("div",{id:"Controls"},r.a.createElement(ne.a,{onClick:n},t?r.a.createElement(oe.a,{glyph:"play"}):r.a.createElement(oe.a,{glyph:"pause"})),r.a.createElement("div",{id:"txToggle"},"Send Transactions ",r.a.createElement(ie.a,{onChange:o})),r.a.createElement(ne.a,{onClick:i},r.a.createElement(oe.a,{glyph:"question-sign"})))},se=n(88),ce=n.n(se);function le(e){return(le="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function de(e,t){return!t||"object"!==le(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.getPrototypeOf||function(e){return e.__proto__})(e)}var fe=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=de(this,pe(t).call(this,e))).invalidNonceTxs=[],n}var n,o,i;return n=t,(o=[{key:"updateInvalidNonceTxs",value:function(){var e=this.invalidNonceTxs,t=this.props.node,n=[],o=[];Object.keys(t.invalidNonceTxs).forEach(function(e,o){Object.keys(t.invalidNonceTxs[e]).forEach(function(o,r){var i=t.invalidNonceTxs[e][o];n.push(i.contents)})});var r=!0,i=!1,a=void 0;try{for(var s,c=function(){var e=s.value;n.find(function(t){return ce.a.isEqual(t,e)})&&o.push(e)},l=e[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)c()}catch(e){i=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}for(var u=function(){var e=n[h];o.find(function(t){return ce.a.isEqual(e,t)})||o.push(e)},h=0;h<n.length;h++)u();this.invalidNonceTxs=o}},{key:"clicked",value:function(e,t){e(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,o=t.icons,i=t.showState;this.updateInvalidNonceTxs();var a=Object.keys(n.state).map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.substring(0,5)),r.a.createElement("td",null,n.state[e].balance),r.a.createElement("td",null,n.state[e].nonce))}),s=this.invalidNonceTxs.map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.from.substring(0,5)),r.a.createElement("td",null,e.to.substring(0,5)),r.a.createElement("td",null,e.amount),r.a.createElement("td",null,e.nonce))}),c=r.a.createElement("div",{style:this.invalidNonceTxs.length?{}:{display:"none"}},r.a.createElement("p",null,"Invalid Nonce Transactions"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"From"),r.a.createElement("th",null,"To"),r.a.createElement("th",null,"Amount"),r.a.createElement("th",null,"Nonce")),s))),l=Number.parseInt(n.color.slice(1),16),u="white";return(.299*(l>>16&255)+.587*(l>>8&255)+.114*(255&l))/255>.5&&(u="black"),r.a.createElement("div",{className:"Ledger",id:"ledger-"+n.pid,style:{backgroundColor:n.color,color:u}},r.a.createElement("img",{alt:"Gerbil",src:o[n.pid],width:"30"}),r.a.createElement("span",{className:"ledger-title"}," "+n.pid.substring(0,5)),r.a.createElement("button",{className:"LedgerMinimizeButton",onClick:function(t){return e.clicked(i,n)}},r.a.createElement("div",{className:"LedgerMinimizeButtonIcon",style:{backgroundColor:u}})),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Address"),r.a.createElement("th",null,"Balance"),r.a.createElement("th",null,"Nonce"),r.a.createElement("th",null,"            ")),a)),c)}}])&&he(n.prototype,o),i&&he(n,i),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");ue(e.prototype,t&&t.prototype),t&&ue(e,t)}(t,e),t}(o.Component),ge=function(e){var t=e.nodes,n=e.icons,o=e.showState;return r.a.createElement("div",{id:"Ledgers"},Object.keys(t).map(function(e,i){return r.a.createElement(fe,{key:e,node:t[e],icons:n,showState:o})}))},ye=n(93),me=n(73),ve=n(91),be=n(212),ke=function(e){var t=e.show,n=e.handleClose,o=r.a.createElement(ye.a,{id:"modal-popover",title:""},"For the technical people: We took the first 6 hexadecimal characters of the Keccak-256 hash of the state and turned it into a hex color!"),i=r.a.createElement(ye.a,{id:"modal-popover",title:"Spend"},'Clicking "Spend" will make the selected node generate and propagate a transaction sending $10 to a random node.'),a=r.a.createElement(ye.a,{id:"modal-popover",title:"Double Spend"},'Clicking "Double Spend" will make the selected node generate and selectively propagate two transactions each sending $10 to a different peer.',r.a.createElement("br",null)),s=r.a.createElement(ye.a,{id:"modal-popover",title:"Resume Transactions"},'Switching on "Resume Transactions" will make all nodes randomly generate and send transactions.',r.a.createElement("br",null));return r.a.createElement(me.a,{show:t,onHide:n},r.a.createElement(me.a.Header,{closeButton:!0},r.a.createElement(me.a.Title,null,"Instructions")),r.a.createElement(me.a.Body,null,r.a.createElement("h4",null,"What is this?"),r.a.createElement("p",null,"This is an interactive network simulation designed as a part of Chapter 2 of "," ",r.a.createElement("a",{href:"https://cryptoeconomics.study/"},"Cryptoeconomics.study"),". To best understand the double spend problem, here is Ethereum Researcher Karl Floersch's explanation in section 2.2 of the course:",r.a.createElement(be.a,{videoId:"k6JVGR7Jx0A",opts:{height:"300",width:"550",playerVars:{autoplay:0}}})),r.a.createElement("h4",null,"How do you send a transaction?"),r.a.createElement("p",null,"Click on a node to either "," ",r.a.createElement(ve.a,{overlay:i},r.a.createElement("a",{href:""},"Spend"))," "," or "," ",r.a.createElement(ve.a,{overlay:a},r.a.createElement("a",{href:""},"Double Spend"))," ",". You can also toggle the "," ",r.a.createElement(ve.a,{overlay:s},r.a.createElement("a",{href:""},"Resume Transactions"))," ","switch."),r.a.createElement("h4",null,"Why is my network graphso small?"),r.a.createElement("p",null,"To increase the size of the network graph, hover over it and scroll upwards. You can also reposition the graph by dragging it around."),r.a.createElement("h4",null,"What do the colors mean?"),r.a.createElement("p",null,"The color of each node "," ",r.a.createElement(ve.a,{overlay:o},r.a.createElement("a",{href:""},"represents"))," "," the state of that node's ledger.")),r.a.createElement(me.a.Footer,null,r.a.createElement(ne.a,{onClick:n},"Close")))};function Oe(e){return(Oe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function we(e){return(we=Object.getPrototypeOf||function(e){return e.__proto__})(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _e=function(e){function t(e){var n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(n=!(r=we(t).call(this,e))||"object"!==Oe(r)&&"function"!==typeof r?Ne(o):r).clicked=n.clicked.bind(Ne(Ne(n))),n}var n,o,i;return n=t,(o=[{key:"clicked",value:function(e,t){e(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.isSelected,o=t.icons,i=t.node,a=t.showState,s={height:"45px",width:"45px",backgroundColor:i.color,borderRadius:"50%",display:n?"none":"flex"};return i?r.a.createElement("div",{onClick:function(t){return e.clicked(a,i)},className:"TrayButton",id:"trayButton-"+i.pid,style:s},r.a.createElement("img",{alt:"Gerbil",src:o[i.pid],width:"25"})):r.a.createElement("div",null)}}])&&Ee(n.prototype,o),i&&Ee(n,i),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Se(e.prototype,t&&t.prototype),t&&Se(e,t)}(t,e),t}(o.Component),Te=function(e){var t=e.nodes,n=e.selectedNodes,o=e.icons,i=e.showState;return r.a.createElement("div",{id:"Tray"},Object.keys(t).map(function(e,a){return r.a.createElement(_e,{key:e,isSelected:t[e].pid in n,icons:o,node:t[e],showState:i})}))},Ce=n(207),xe=n.n(Ce);function Me(e){return(Me="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){Pe(e,t,n[t])})}return e}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Re(e,t){return!t||"object"!==Me(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(e){return(De=Object.getPrototypeOf||function(e){return e.__proto__})(e)}for(var Ie=["https://i.imgur.com/Wi9yFXw.png","https://i.imgur.com/U5Y99Rm.png","https://i.imgur.com/NPH4rqg.png","https://i.imgur.com/MptO0GC.png","https://i.imgur.com/yHwPVBF.png","https://i.imgur.com/yvv1MMb.png","https://i.imgur.com/I4Dlkik.png","https://i.imgur.com/jNB8LS6.png"],We={nodes:[],links:[]},Ge={},ze=0;ze<te.nodes.length;ze++)We.nodes.push({id:te.nodes[ze].pid,name:te.nodes[ze].pid.slice(0,5),gerbil:Ie[ze]}),Ge[te.nodes[ze].pid]=Ie[ze];var Be=!0,Fe=!1,He=void 0;try{for(var Ye,Ke=te.nodes[Symbol.iterator]();!(Be=(Ye=Ke.next()).done);Be=!0){var Ue=Ye.value,Qe=!0,qe=!1,Je=void 0;try{for(var Ze,Ve=te.network.peers[Ue.pid][Symbol.iterator]();!(Qe=(Ze=Ve.next()).done);Qe=!0){var Xe=Ze.value;We.links.push({source:Ue.pid,target:Xe.pid})}}catch(g){qe=!0,Je=g}finally{try{Qe||null==Ve.return||Ve.return()}finally{if(qe)throw Je}}}}catch(g){Fe=!0,He=g}finally{try{Be||null==Ke.return||Ke.return()}finally{if(Fe)throw He}}var $e={automaticRearrangeAfterDropNode:!0,staticGraph:!1,nodeHighlightBehavior:!0,node:{size:400,highlightStrokeColor:"blue",labelProperty:"name"},link:{highlightColor:"lightblue"}},et=function(e,t){window.alert("Clicked link between ".concat(e," and ").concat(t))},tt=function(e,t){},nt=function(e,t){},ot=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Re(this,De(t).call(this))).state={clickedNode:null,selectedNodes:{},history:[],paused:!1,pausedTxs:!0,speed:10,showPopup:!0},e}var n,o,i;return n=t,(o=[{key:"componentDidMount",value:function(){var e=!0,t=!1,n=void 0;try{for(var o,r=te.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var i=o.value;this.showState(i)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"setMessageQueue",value:function(e){var t=e.messageQueue,n=[];return Object.keys(t).forEach(function(e,o){var r=!0,i=!1,a=void 0;try{for(var s,c=t[e][Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;n.push(je({},l,{rcvTime:e}))}}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}}),n}},{key:"tick",value:function(){te.network.tick();var e=this.state.history;e.push(xe()(te.network)),this.setState({history:e})}},{key:"getTick",value:function(e){var t=this.state,n=t.history,o=t.selectedNodes,r=t.clickedNode;if(e>n.length)throw new Error("You skipped a time step!");e===n.length&&this.tick();var i=this.setMessageQueue(n[e]);if(r){var a=this.getNode(r.pid,e);this.setState({clickedNode:a})}for(var s in o)o[s]=this.getNode(s,e);this.setState({selectedNodes:o,messages:i,time:e})}},{key:"getNode",value:function(e,t){var n=this.state.history[t];if(n)return n.agents.find(function(t){return t.pid===e})}},{key:"getCurrNode",value:function(e){if(te.network)return te.network.agents.find(function(t){return t.pid===e})}},{key:"onClickNode",value:function(e){var t=this.state,n=t.clickedNode,o=t.time,r=this.getNode(e,o);n&&r.pid===n.pid?this.setState({clickedNode:null}):this.setState({clickedNode:r})}},{key:"onMouseOverNode",value:function(e){}},{key:"onMouseOutNode",value:function(e){}},{key:"pause",value:function(){this.setState({paused:!this.state.paused})}},{key:"pauseTxs",value:function(){this.setState({pausedTxs:!this.state.pausedTxs});var e=!0,t=!1,n=void 0;try{for(var o,r=te.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var i=o.value;i.pausedSpending=!i.pausedSpending}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"rewind",value:function(){var e=this.state.speed;1.5*e>10||(this.setState({speed:e*=1.5}),console.log("rewind",e))}},{key:"fastforward",value:function(){var e=this.state.speed;e/1.5<.005||(this.setState({speed:e/=1.5}),console.log("fastforward",e))}},{key:"stepbackward",value:function(){console.log("stepbackward");var e=this.state.time;e<1||(this.setState({paused:!0}),this.graph.step(e-1),this.getTick(e-1),this.graph.animate())}},{key:"stepforward",value:function(){console.log("stepforward");var e=this.state.time;this.setState({paused:!0}),this.graph.step(e+1),this.getTick(e+1),this.graph.animate()}},{key:"doubleSpend",value:function(e){var t=e.pid,n=[te.network.peers[t][0],te.network.peers[t][1]],o=[e.generateTx(n[0].wallet.address,10),e.generateTx(n[1].wallet.address,10)];o[0].isDoubleSpend=!0,o[1].isDoubleSpend=!0,te.network.broadcastTo(t,n[0],o[0]),te.network.broadcastTo(t,n[1],o[1]),console.log("Double spender:",t,"victims:",n,"spends:",o)}},{key:"spend",value:function(e){var t=this.getCurrNode(e.pid),n=t.generateTx(t.getRandomReceiver(),10);t.transactions.push(n),t.applyTransaction(n),te.network.broadcast(t.pid,n)}},{key:"showState",value:function(e){var t=this.state.selectedNodes;t[e.pid]?delete t[e.pid]:t[e.pid]=e,this.setState({selectedNodes:t})}},{key:"togglePopup",value:function(){this.setState({showPopup:!this.state.showPopup})}},{key:"deselectNode",value:function(){this.setState({clickedNode:null})}},{key:"reset",value:function(){console.log("reset"),this.getTick(0)}},{key:"setSpeed",value:function(e){var t=e/1e3;this.setState({speed:t}),console.log("speeedooo",t)}},{key:"setLatency",value:function(e){var t=e.target.value,n=Math.min(Math.max(parseInt(t),1),10);console.log("latency",t,n)}},{key:"setPacketLoss",value:function(e){var t=e.target.value,n=Math.min(Math.max(parseInt(t),1),20);console.log("packetloss",t,n)}},{key:"render",value:function(){var e=this,t=this.state,n=t.clickedNode,o=t.selectedNodes,i=t.messages,a=t.time,s=t.paused,c=t.pausedTxs,l=t.speed;return r.a.createElement("div",{id:"App-container"},r.a.createElement("div",{id:"Text-container"},r.a.createElement("div",{id:"Overflow-top"}),r.a.createElement("h3",null,"2.2: The Double Spend"),r.a.createElement("div",{id:"Text"},"Building a centralized payments processor like Paypal is simple, but relies on trust that Paypal will not break the rules. A simple way to decentralize PayPal is to make clients download all transactions and run the PayPal code to generate their belief of the current state.",r.a.createElement("br",null),r.a.createElement("br",null),"In a decentralized system, we cannot rely on a global clock, and we cannot assume a constant latency for all messages to be delivered.",r.a.createElement("br",null),r.a.createElement("br",null),"This is the root cause of the double spend problem: an attacker can send one message to Jing & another message to Karl each spending the same coins. If Jing and Karl both accept those transactions, their states will diverge and we will have a fork. Not good! We need decentralized consensus!"),r.a.createElement("div",{id:"Overflow-bottom"})),r.a.createElement("div",{id:"Network-container"},r.a.createElement("div",{id:"Graph-container"},r.a.createElement(Te,{nodes:te.nodes,selectedNodes:o,showState:this.showState.bind(this),icons:Ge}),r.a.createElement(ge,{nodes:o,showState:this.showState.bind(this),icons:Ge}),r.a.createElement(ee,{ref:function(t){e.graph=t},id:"graph-id",data:We,config:$e,onClickNode:this.onClickNode.bind(this),clickedNode:n,onClickLink:et,onMouseOverNode:this.onMouseOverNode.bind(this),onMouseOutNode:this.onMouseOutNode.bind(this),onMouseOverLink:tt,onMouseOutLink:nt,doubleSpend:this.doubleSpend.bind(this),spend:this.spend.bind(this),deselectNode:this.deselectNode.bind(this),messages:i,time:a,speed:l,paused:s,onTick:this.getTick.bind(this),nodeState:this.getNode.bind(this)})),r.a.createElement("div",{id:"Input-container"},r.a.createElement("div",{id:"Controls-container"},r.a.createElement(ae,{onPause:this.pause.bind(this),onPauseTxs:this.pauseTxs.bind(this),paused:s,pausedTxs:c,togglePopup:this.togglePopup.bind(this),stepbackward:this.stepbackward.bind(this),stepforward:this.stepforward.bind(this),rewind:this.rewind.bind(this),fastforward:this.fastforward.bind(this),reset:this.reset.bind(this)})))),r.a.createElement(ke,{show:this.state.showPopup,handleClose:this.togglePopup.bind(this)}))}}])&&Ae(n.prototype,o),i&&Ae(n,i),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Le(e.prototype,t&&t.prototype),t&&Le(e,t)}(t,e),t}(o.Component),rt=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(ot,null))},it=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function at(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}a.a.render(r.a.createElement(rt,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/code",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/code","/service-worker.js");it?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):at(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):at(e)})}}()},318:function(e,t,n){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=n(138);function i(e){return r.hash.keccak256(JSON.stringify(e))}function a(e){return"#"+r.hash.keccak256(JSON.stringify(e)).substr(-6)}var s=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wallet=t,this.pid=t.address,this.network=o,this.state=n,this.color=a(n),this.transactions=[],this.invalidNonceTxs={}}var t,n,s;return t=e,(n=[{key:"onReceive",value:function(e){this.transactions.includes(e)||(this.transactions.push(e),this.applyTransaction(e),this.network.broadcast(this.pid,e),this.applyInvalidNonceTxs(e.contents.from))}},{key:"applyInvalidNonceTxs",value:function(e){var t=this.state[e].nonce;e in this.invalidNonceTxs&&t in this.invalidNonceTxs[e]&&(this.applyTransaction(this.invalidNonceTxs[e][t]),delete this.invalidNonceTxs[e][t],this.applyInvalidNonceTxs(e))}},{key:"tick",value:function(){}},{key:"generateTx",value:function(e,t){var n={type:"send",amount:t,from:this.wallet.address,to:e,nonce:this.state[this.wallet.address].nonce};return{contents:n,sig:r.sign(this.wallet.privateKey,i(n))}}},{key:"applyTransaction",value:function(e){if(r.recover(e.sig,i(e.contents))!==e.contents.from)throw new Error("Invalid signature!");if(e.contents.to in this.state||(this.state[[e.contents.to]]={balance:0,nonce:0}),e.contents.nonce!==this.state[[e.contents.from]].nonce)return e.contents.from in this.invalidNonceTxs||(this.invalidNonceTxs[e.contents.from]={}),void(this.invalidNonceTxs[e.contents.from][e.contents.nonce]=e);if("send"!==e.contents.type)throw new Error("Invalid transaction type!");this.state[[e.contents.from]].balance-e.contents.amount<0||(this.state[[e.contents.from]].balance-=e.contents.amount,this.state[[e.contents.to]].balance+=e.contents.amount,this.state[[e.contents.from]].nonce+=1,this.color=a(this.state))}}])&&o(t.prototype,n),s&&o(t,s),e}();e.exports={Node:s,getTxHash:i}},319:function(e,t){},328:function(e,t,n){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=n(88),i=n(227),a=n(327),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o=i.randomNormal.source(a("a22ebc7c488a3a47"))(t,2*t/5);this.agents=[],this.latencyDistribution=function(){return Math.floor(Math.max(o(),0))},this.time=0,this.messageQueue={},this.peers={},this.packetLoss=n}var t,n,s;return t=e,(n=[{key:"connectPeer",value:function(e,t){e.network=this;var n=r.shuffle(this.agents);this.agents.push(e),this.peers[e.pid]=[];var o=!0,i=!1,a=void 0;try{for(var s,c=n.slice(0,t)[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;this.peers[e.pid].push(l),this.peers[l.pid].push(e)}}catch(e){i=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}}},{key:"broadcast",value:function(e,t){var n=!0,o=!1,r=void 0;try{for(var i,a=this.peers[e][Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.broadcastTo(e,s,t)}}catch(e){o=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}}},{key:"broadcastTo",value:function(e,t,n){var o=this.time+this.latencyDistribution();o in this.messageQueue||(this.messageQueue[o]=[]),this.messageQueue[o].push({sender:e,sentTime:this.time,recipient:t,recvTime:o,message:n})}},{key:"tick",value:function(){if(this.time in this.messageQueue){var e=!0,t=!1,n=void 0;try{for(var o,r=this.messageQueue[this.time][Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var i=o.value,a=i.recipient,s=i.message;Math.random()>this.packetLoss&&a.onReceive(s)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}delete this.messageQueue.time}var c=!0,l=!1,u=void 0;try{for(var h,d=this.agents[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){h.value.tick()}}catch(e){l=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw u}}this.time+=1}},{key:"run",value:function(e){for(var t=0;t<e;t++)this.tick()}}])&&o(t.prototype,n),s&&o(t,s),e}();e.exports=s},408:function(e,t){},411:function(e,t){},432:function(e,t){},434:function(e,t){},440:function(e,t,n){},441:function(e,t,n){},455:function(e,t,n){n(454),e.exports=n(228)}},[[455,0,1]]]);
//# sourceMappingURL=main.57abf8b7.chunk.js.map